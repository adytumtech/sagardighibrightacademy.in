<!-- Hero Section -->
<section class="hero-section h-[300px] bg-dark-9 bg-cover bg-center flex items-center justify-center" style="background-image:url(<?php echo URL ?>assets/img/hero_img.jpg)">
  <div class="container mx-auto px-4">
    <div class="flex flex-col items-center justify-center text-white text-center">
      <h1 class="text-2xl md:text-4xl font-bold mb-2 bg-red-700 px-5 py-2">Gallery</h1>
    </div>
  </div>
</section>

<!-- Gallery Section -->
<!-- <section class="py-12 bg-gray-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">


  <h1 class="text-center text-xl md:text-5xl text-red-600" >Comming Soon.....</h1> -->
    <!-- <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3 text-start">School Gallery</h2>
      <p class="text-lg text-gray-600 text-start">Explore our vibrant school life through our photo gallery, capturing cherished moments and memorable events.</p>
    </div> -->

    <!-- Gallery Grid -->
    <!-- <ul class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
   
       <li class="group relative">
        <div class="aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-lg transition-all duration-300 transform group-hover:shadow-xl group-hover:-translate-y-2">
          <img src="<?php echo URL ?>assets/img/celebration.jpg" alt="Celebration"
            class="object-cover w-full h-full min-h-[280px] max-h-[320px] min-w-full max-w-full transition-transform duration-500 group-hover:scale-105" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
            <div class="text-white">
              <h3 class="text-xl font-bold mb-1">Celebration</h3>
              <p class="text-sm opacity-0 group-hover:opacity-100 transition-opacity delay-100 duration-200">Festivals and special events at our school</p>
            </div>
          </div>
          <a href="<?php echo URL ?>gallery/celebration" class="absolute inset-0 z-10" aria-label="View Celebration images"></a>
        </div>
      </li>

   
      <li class="group relative">
        <div class="aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-lg transition-all duration-300 transform group-hover:shadow-xl group-hover:-translate-y-2">
          <img src="<?php echo URL ?>assets/img/sports/img-1.jpg" alt="Sports and Activities"
            class="object-cover w-full h-full min-h-[280px] max-h-[320px] min-w-full max-w-full transition-transform duration-500 group-hover:scale-105" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
            <div class="text-white">
              <h3 class="text-xl font-bold mb-1">Sports and Activities</h3>
              <p class="text-sm opacity-0 group-hover:opacity-100 transition-opacity delay-100 duration-200">Students engaging in sports and extracurricular activities</p>
            </div>
          </div>
          <a href="<?php echo URL ?>gallery/sport_activities" class="absolute inset-0 z-10" aria-label="View Sports and Activities images"></a>
        </div>
      </li>

   
      <li class="group relative">
        <div class="aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-lg transition-all duration-300 transform group-hover:shadow-xl group-hover:-translate-y-2">
          <img src="<?php echo URL ?>assets/img/hero-images/img-8.jpg" alt="Academic Excellence"
            class="object-cover w-full h-full min-h-[280px] max-h-[320px] min-w-full max-w-full transition-transform duration-500 group-hover:scale-105" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
            <div class="text-white">
              <h3 class="text-xl font-bold mb-1">Academic Excellence</h3>
              <p class="text-sm opacity-0 group-hover:opacity-100 transition-opacity delay-100 duration-200">Our students achieving academic milestones</p>
            </div>
          </div>
          <a href="#" class="absolute inset-0 z-10" aria-label="View Academic Excellence images"></a>
        </div>
      </li>

    
        <li class="group relative">
        <div class="aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-lg transition-all duration-300 transform group-hover:shadow-xl group-hover:-translate-y-2">
          <img src="<?php echo URL ?>assets/img/db-front-3.jpg" alt="School Campus"
            class="object-cover w-full h-full min-h-[280px] max-h-[320px] min-w-full max-w-full transition-transform duration-500 group-hover:scale-105" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
            <div class="text-white">
              <h3 class="text-xl font-bold mb-1">School Campus</h3>
              <p class="text-sm opacity-0 group-hover:opacity-100 transition-opacity delay-100 duration-200">Our beautiful school facilities and learning environment</p>
            </div>
          </div>
          <a href="#" class="absolute inset-0 z-10" aria-label="View School Campus images"></a>
        </div>
      </li>
    

      
      <li class="group relative">
        <div class="aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-lg transition-all duration-300 transform group-hover:shadow-xl group-hover:-translate-y-2">
          <img src="https://images.unsplash.com/photo-1571260899304-425eee4c7efc?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Faculty"
            class="object-cover w-full h-full min-h-[280px] max-h-[320px] min-w-full max-w-full transition-transform duration-500 group-hover:scale-105" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
            <div class="text-white">
              <h3 class="text-xl font-bold mb-1">Faculty</h3>
              <p class="text-sm opacity-0 group-hover:opacity-100 transition-opacity delay-100 duration-200">Our dedicated teaching staff and mentors</p>
            </div>
          </div>
          <a href="#" class="absolute inset-0 z-10" aria-label="View Faculty images"></a>
        </div>
      </li>

      <li class="group relative">
        <div class="aspect-w-1 aspect-h-1 rounded-xl overflow-hidden shadow-lg transition-all duration-300 transform group-hover:shadow-xl group-hover:-translate-y-2">
          <img src="https://images.unsplash.com/photo-1434030216411-0b793f4b4173?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Student Life"
            class="object-cover w-full h-full min-h-[280px] max-h-[320px] min-w-full max-w-full transition-transform duration-500 group-hover:scale-105" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
            <div class="text-white">
              <h3 class="text-xl font-bold mb-1">Student Life</h3>
              <p class="text-sm opacity-0 group-hover:opacity-100 transition-opacity delay-100 duration-200">Daily life and interactions of our students</p>
            </div>
          </div>
          <a href="#" class="absolute inset-0 z-10" aria-label="View Student Life images"></a>
        </div>
      </li>

    </ul> -->
  <!-- </div>
</section> -->




<!-- ================= Dynamic Timeline Gallery ================= -->



<div class="max-w-6xl mx-auto px-4 my-10">
  <div class="relative">


    <div id="timeline"></div>
  </div>


</div>

<script>
  const timeline = document.getElementById("timeline");

  /* ---------------- CATEGORY THEME (TAILWIND SAFE) ---------------- */
  const categoryTheme = {
    Sports: {
      text: "text-green-700",
      bg: "bg-green-50",
      border: "border-green-200"
    },
    Cultural: {
      text: "text-amber-700",
      bg: "bg-amber-50",
      border: "border-amber-200"
    },
    Academic: {
      text: "text-blue-700",
      bg: "bg-blue-50",
      border: "border-blue-200"
    },
    Science: {
      text: "text-purple-700",
      bg: "bg-purple-50",
      border: "border-purple-200"
    },
    Environment: {
      text: "text-emerald-700",
      bg: "bg-emerald-50",
      border: "border-emerald-200"
    },
    Awards: {
      text: "text-red-700",
      bg: "bg-red-50",
      border: "border-red-200"
    },
    "Large Event": {
      text: "text-indigo-700",
      bg: "bg-indigo-50",
      border: "border-indigo-200"
    },
    Other: {
      text: "text-gray-700",
      bg: "bg-gray-50",
      border: "border-gray-200"
    }
  };

  function getCategoryIcon(category) {
    const icons = {
      Sports: "fa-running",
      Cultural: "fa-music",
      Academic: "fa-graduation-cap",
      Science: "fa-flask",
      Environment: "fa-tree",
      Awards: "fa-award",
      "Large Event": "fa-users",
      Other: "fa-calendar-alt"
    };
    return icons[category] || "fa-calendar-day";
  }

  window.allGalleryData = [];

 async function loadTimeline() {
  try {
    //  Show loading UI first
    timeline.innerHTML = `
      <div class="w-full flex justify-center items-center py-20">
        <div class="flex flex-col items-center gap-3 text-gray-500">
          <i class="fas fa-spinner fa-spin text-3xl text-blue-500"></i>
          <span class="text-lg font-medium">Loading gallery...</span>
        </div>
      </div>
    `;

    const res = await fetch("<?php echo URL ?>gallery/getGalleryEvents");
    const response = await res.json();

    window.allGalleryData = response.data || [];
    timeline.innerHTML = ""; //  Remove loading

    if (response.success && Array.isArray(response.data)) {
      response.data.forEach((item, index) => {
        const date = item.formatted_event_date || item.event_date;
        const category = item.category || "Other";
        const title = item.title;
        const description = item.description || "";
        const images = Array.isArray(item.images) ? item.images : [];

        const theme = categoryTheme[category] || categoryTheme.Other;
        const icon = getCategoryIcon(category);

        const showViewMoreCard = images.length > 4;
        const visibleImages = showViewMoreCard ? images.slice(0, 3) : images.slice(0, 4);
        const remainingCount = images.length - 3;

        let imagesHTML = visibleImages.map((img, imgIdx) => `
          <div onclick="openGalleryModal(window.allGalleryData[${index}].images, ${imgIdx})"
            class="group relative overflow-hidden rounded-lg shadow-sm cursor-pointer h-48 md:h-56">
            <img src="${img}" class="w-full h-full object-cover rounded-lg transition-transform duration-300 group-hover:scale-105">
            <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center rounded-lg">
              <i class="fas fa-search-plus text-white text-lg"></i>
            </div>
          </div>
        `).join("");

        if (showViewMoreCard) {
          imagesHTML += `
            <div onclick="openGalleryModal(window.allGalleryData[${index}].images, 3)"
              class="group relative overflow-hidden rounded-lg shadow-sm h-48 md:h-56 cursor-pointer">
              <img src="${images[3]}" class="w-full h-full object-cover rounded-lg transition-transform duration-300 group-hover:scale-105">
              <div class="absolute inset-0 bg-black/70 flex items-center justify-center rounded-lg">
                <div class="text-white text-center">
                  <div class="text-3xl font-bold">+${remainingCount}</div>
                  <div class="text-sm">View All</div>
                </div>
              </div>
            </div>
          `;
        }

        timeline.innerHTML += `
          <div class="relative flex items-start mb-12 md:mb-16 ">
            <div class="md:ml-16 flex flex-col gap-3 w-full bg-white border p-5 rounded-lg shadow-lg hover:shadow-xl">
              <div class="flex items-center gap-2">
               <div class=" px-3 py-1 rounded-full border ${theme.bg} ${theme.text} ${theme.border} text-xs font-medium">
                  <i class="fas ${icon} mr-1"></i>${category}
                </div>
                <div class="flex items-center text-gray-700 font-semibold">
                
                  <span class="text-sm">${date}</span>
                </div>

               
              </div>

              <h2 class="text-xl md:text-2xl font-bold text-gray-900">${title}</h2>
              <p class="text-gray-600 text-sm md:text-base leading-relaxed">${description}</p>

              <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                ${imagesHTML}
              </div>

              <hr class="border-t border-gray-200 my-2">

              <div class="flex items-center justify-between">
                <div class="flex items-center text-gray-600">
                  <i class="fas fa-images text-blue-500 mr-2"></i>
                  <span>${images.length} images</span>
                </div>
                <button onclick="openGalleryModal(window.allGalleryData[${index}].images, 0)"
                  class="flex items-center text-blue-600 hover:text-blue-800 font-medium group">
                  <span class="group-hover:underline">View all images</span>
                  <i class="fas fa-arrow-right ml-2 text-sm group-hover:translate-x-1 transition-transform"></i>
                </button>
              </div>
            </div>
          </div>
        `;
      });
    }
  } catch (err) {
    console.error(err);
    timeline.innerHTML = `
      <div class="text-center py-16 text-red-500">
        Failed to load gallery 
      </div>
    `;
  }
}


  loadTimeline();





document.addEventListener("DOMContentLoaded", function () {
  // Global variables to store current state
  let currentGalleryImages = [];
  let currentGalleryIndex = 0;

  const modal = document.getElementById("imageModal");
  const modalImg = document.getElementById("modalImage");
  const currentDisplay = document.getElementById("currentIndexDisplay");
  const totalDisplay = document.getElementById("totalIndexDisplay");

  // 1. Function to OPEN the modal
  window.openGalleryModal = function (images, startIndex = 0) {
    if (!images || images.length === 0) return;

    // Store the images for this specific event
    currentGalleryImages = images;
    currentGalleryIndex = startIndex;

    // Show the modal
    updateModalImage();
    modal.classList.remove("hidden");

    // Disable body scroll
    document.body.style.overflow = "hidden";
  };

  // 2. Function to CLOSE the modal
  window.closeGalleryModal = function () {
    modal.classList.add("hidden");
    currentGalleryImages = [];
    // Enable body scroll
    document.body.style.overflow = "auto";
  };

  // 3. Update Image Source & Counters
  function updateModalImage() {
    if (currentGalleryImages.length > 0) {
      modalImg.src = currentGalleryImages[currentGalleryIndex];

      // Update counters (1 / 5)
      if (currentDisplay) currentDisplay.innerText = currentGalleryIndex + 1;
      if (totalDisplay) totalDisplay.innerText = currentGalleryImages.length;
    }
  }

  // 4. Next Image
  window.nextGalleryImage = function () {
    currentGalleryIndex =
      (currentGalleryIndex + 1) % currentGalleryImages.length;
    updateModalImage();
  };

  // 5. Prev Image
  window.prevGalleryImage = function () {
    currentGalleryIndex =
      (currentGalleryIndex - 1 + currentGalleryImages.length) %
      currentGalleryImages.length;
    updateModalImage();
  };

  // 6. Keyboard Support (Arrow keys & Escape)
  document.addEventListener("keydown", function (e) {
    if (modal.classList.contains("hidden")) return;

    if (e.key === "Escape") closeGalleryModal();
    if (e.key === "ArrowRight") nextGalleryImage();
    if (e.key === "ArrowLeft") prevGalleryImage();
  });

  // 7. Click outside image to close
  modal.addEventListener("click", function (e) {
    if (e.target === modal) {
      closeGalleryModal();
    }
  });

  // 8. Touch Swipe Support for Mobile
  let touchStartX = 0;
  let touchEndX = 0;

  modal.addEventListener('touchstart', function(event) {
    touchStartX = event.changedTouches[0].screenX;
  }, false);

  modal.addEventListener('touchend', function(event) {
    touchEndX = event.changedTouches[0].screenX;
    handleSwipeGesture();
  }, false);

  function handleSwipeGesture() {
    const swipeThreshold = 50; // Minimum distance for swipe to be recognized

    if (touchStartX - touchEndX > swipeThreshold) {
      // Swipe left - next image
      nextGalleryImage();
    } else if (touchEndX - touchStartX > swipeThreshold) {
      // Swipe right - previous image
      prevGalleryImage();
    }
  }
});








</script>


<!-- Image Modal with Carousel -->
<div id="imageModal" class="fixed inset-0 z-50 hidden bg-black/90 backdrop-blur-sm">
  <div class="flex items-center justify-center h-full">
    <!-- Close Button -->
    <button onclick="closeGalleryModal()" class="absolute top-4 right-4 text-white text-3xl z-10 hover:text-gray-300 focus:outline-none transition-transform duration-200 hover:scale-110 bg-black/30 hover:bg-black/50 rounded-full w-10 h-10 flex items-center justify-center">
      <i class="fas fa-times"></i>
    </button>

    <!-- Previous Button -->
    <button onclick="prevGalleryImage()" class="absolute left-4 text-white z-10 hover:text-gray-300 focus:outline-none hidden md:block bg-black/40 hover:bg-black/70 rounded-full w-14 h-14 flex items-center justify-center transition-all duration-300 shadow-lg hover:shadow-xl">
      <i class="fas fa-chevron-left text-2xl"></i>
    </button>

    <!-- Next Button -->
    <button onclick="nextGalleryImage()" class="absolute right-4 text-white z-10 hover:text-gray-300 focus:outline-none hidden md:block bg-black/40 hover:bg-black/70 rounded-full w-14 h-14 flex items-center justify-center transition-all duration-300 shadow-lg hover:shadow-xl">
      <i class="fas fa-chevron-right text-2xl"></i>
    </button>

    <!-- Main Image Container -->
    <div class="relative max-w-6xl w-full max-h-[90vh] px-4 flex flex-col items-center">
      <div class="relative overflow-hidden rounded-lg shadow-2xl">
        <img id="modalImage" class="w-full h-auto max-h-[75vh] object-contain mx-auto" src="" alt="Gallery Image">

        <!-- Mobile Navigation Arrows -->
        <div class="md:hidden absolute inset-0 flex items-center justify-between px-2">
          <button onclick="prevGalleryImage()" class="text-white text-2xl p-3 bg-black/40 hover:bg-black/60 rounded-full transition-all duration-300 shadow-lg">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button onclick="nextGalleryImage()" class="text-white text-2xl p-3 bg-black/40 hover:bg-black/60 rounded-full transition-all duration-300 shadow-lg">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>

      <!-- Counter Display -->
      <div class="mt-4 text-white text-lg bg-black/40 px-4 py-2 rounded-full">
        <span id="currentIndexDisplay">1</span> / <span id="totalIndexDisplay">1</span>
      </div>
    </div>
  </div>
</div>
</section>
